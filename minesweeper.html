<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minesweeper - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å</title>
<style>
  body { font-family:"Segoe UI"; text-align:center; margin:0; padding:20px; transition:background 0.3s,color 0.3s; }
  h1 { margin-bottom:10px; }
  select, button { padding:8px 16px; margin:10px; font-size:16px; border-radius:6px; border:none; cursor:pointer; }
  #board { display:grid; justify-content:center; margin:20px auto; gap:2px; }
  .cell { width:28px;height:28px; display:flex; justify-content:center; align-items:center; font-size:15px; cursor:pointer; border-radius:5px; user-select:none; transition:background 0.15s; }
  .cell.revealed { cursor:default; }
  .cell.mine { color:white; }
  #win-screen { position:fixed; inset:0; background:rgba(0,0,0,0.9); display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; color:#fff; z-index:999; visibility:hidden; opacity:0; transition:opacity 0.4s, visibility 0.4s; }
  #win-screen.show { visibility:visible; opacity:1; }
  #win-screen h2 { font-size:2.5em; color:#3fb950; margin-bottom:10px; }
  #win-screen p { color:#8b949e; margin-bottom:20px; }
  #win-screen button { background-color:#238636; color:white; border-radius:8px; padding:10px 20px; font-size:18px; cursor:pointer; border:none; }
  #win-screen button:hover { background-color:#2ea043; }

  body.dark { background-color:#0d1117; color:#e6edf3; }
  body.dark .cell { background-color:#161b22; border:1px solid #30363d; }
  body.dark .cell.revealed { background-color:#21262d; }
  body.dark .cell.mine { background-color:#da3633; }

  body.light { background-color:#f0f0f0; color:#111; }
  body.light .cell { background-color:#fff; border:1px solid #aaa; }
  body.light .cell.revealed { background-color:#ddd; }
  body.light .cell.mine { background-color:#e03e3e; }

  canvas.confetti { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:1000; }
</style>
</head>
<body class="dark">
<h1>üí£ Minesweeper</h1>

<label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å: 
<select id="difficulty">
  <option value="easy">‡∏á‡πà‡∏≤‡∏¢ 10√ó10 ‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î10</option>
  <option value="medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á 14√ó14 ‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î40</option>
  <option value="hard">‡∏¢‡∏≤‡∏Å 24√ó24 ‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î99</option>
</select>
</label>

<label>‡∏ò‡∏µ‡∏°: 
<select id="theme">
  <option value="dark">‡∏°‡∏∑‡∏î</option>
  <option value="light">‡∏™‡∏ß‡πà‡∏≤‡∏á</option>
</select>
</label>

<button onclick="startGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏° üîÑ</button>

<div id="board"></div>

<div id="win-screen">
  <h2>üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! üéâ</h2>
  <p>‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÇ‡∏î‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î!</p>
  <button onclick="closeWinScreen()">‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á üîÅ</button>
</div>

<audio id="bg-music" src="225d00c3-251f-401b-bd89-f0529e917ccf.mp3" loop autoplay></audio>
<audio id="click-sound" src="https://freesound.org/data/previews/256/256113_3263906-lq.mp3"></audio>
<audio id="bomb-sound" src="https://pixabay.com/th/sound-effects/explosion-fx-343683/"></audio>
<audio id="win-sound" src="0186ae7b-a88d-42c5-9e6f-83ee624eaaad.mp3"></audio>

<canvas id="confetti-canvas" class="confetti"></canvas>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
let rows, cols, mineCount;
let grid = [];
let revealedCount = 0;
let gameOver = false;
const board = document.getElementById('board');
const winScreen = document.getElementById('win-screen');
const clickSound = document.getElementById('click-sound');
const bombSound = document.getElementById('bomb-sound');
const winSound = document.getElementById('win-sound');

function startGame() {
  const difficulty = document.getElementById('difficulty').value;
  const theme = document.getElementById('theme').value;
  document.body.className = theme;

  if(difficulty==='easy'){ rows=10; cols=10; mineCount=10; }
  else if(difficulty==='medium'){ rows=14; cols=14; mineCount=40; }
  else{ rows=24; cols=24; mineCount=99; }

  init();
}

function init() {
  gameOver=false; revealedCount=0; grid=[]; board.innerHTML='';
  winScreen.classList.remove('show');
  board.style.gridTemplateColumns=`repeat(${cols},28px)`;
  for(let r=0;r<rows;r++){
    grid[r]=[];
    for(let c=0;c<cols;c++){
      const cell=document.createElement('div');
      cell.classList.add('cell');
      cell.dataset.row=r; cell.dataset.col=c;
      cell.addEventListener('click',()=>reveal(r,c));
      cell.addEventListener('contextmenu',(e)=>{ e.preventDefault(); toggleFlag(r,c); });
      board.appendChild(cell);
      grid[r][c]={mine:false,revealed:false,flagged:false,el:cell,number:0};
    }
  }
  placeMines(); calculateNumbers();
}

function placeMines(){
  let placed=0;
  while(placed<mineCount){
    const r=Math.floor(Math.random()*rows);
    const c=Math.floor(Math.random()*cols);
    if(!grid[r][c].mine){ grid[r][c].mine=true; placed++; }
  }
}

function calculateNumbers(){
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      if(grid[r][c].mine) continue;
      let count=0;
      for(let dr=-1;dr<=1;dr++){
        for(let dc=-1;dc<=1;dc++){
          const nr=r+dr,nc=c+dc;
          if(nr>=0&&nr<rows&&nc>=0&&nc<cols&&grid[nr][nc].mine) count++;
        }
      }
      grid[r][c].number=count;
    }
  }
}

function reveal(r,c){
  if(gameOver) return;
  const cell=grid[r][c];
  if(cell.revealed||cell.flagged) return;
  cell.revealed=true; revealedCount++;
  cell.el.classList.add('revealed');
  clickSound.play();

  if(cell.mine){
    cell.el.classList.add('mine'); cell.el.textContent="üí£";
    gameOver=true; revealAllMines(); bombSound.play();
    setTimeout(()=>alert("üí• ‡πÄ‡∏Å‡∏°‡∏à‡∏ö! ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î!"),100);
    return;
  }

  if(cell.number>0){
    cell.el.textContent=cell.number;
    cell.el.style.color=["#58a6ff","#3fb950","#f0883e","#f85149","#a371f7","#ff79c6","#00ffff","#111"][cell.number-1];
  } else {
    for(let dr=-1;dr<=1;dr++){ for(let dc=-1;dc<=1;dc++){
      const nr=r+dr,nc=c+dc; if(nr>=0&&nr<rows&&nc>=0&&nc<cols) reveal(nr,nc);
    }}
  }

  if(revealedCount===rows*cols-mineCount) showWinScreen();
}

function toggleFlag(r,c){
  if(gameOver) return;
  const cell=grid[r][c]; if(cell.revealed) return;
  cell.flagged=!cell.flagged;
  cell.el.textContent=cell.flagged?"üö©":"";
}

function revealAllMines(){
  for(let r=0;r<rows;r++){ for(let c=0;c<cols;c++){
    const cell=grid[r][c]; if(cell.mine){ cell.el.textContent="üí£"; cell.el.classList.add('mine'); }
  }}
}

function showWinScreen(){
  gameOver=true; winScreen.classList.add('show'); winSound.play();
  confetti({particleCount:150,spread:70,origin:{y:0.6}});
  confetti({particleCount:100,spread:100,origin:{y:0.6}});
}

function closeWinScreen(){ winScreen.classList.remove('show'); init(); }
</script>
</body>
</html>
